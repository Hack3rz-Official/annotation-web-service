user  nginx;
events {
    worker_connections   1000;
}
http {

        # defines the servers that are used to balance the traffic
        upstream annotation-service {
            #URL of the docker instance
            # first part refers to the name of the service in docker-compose
            server annotation-web-service-annotation-1:8083;
            server annotation-web-service-annotation-2:8083;
        }

        upstream prediction-service {
            # URL of the docker instance
            # first part refers to the name of the service in docker-compose
            server annotation-web-service-prediction-1:5000;
            server annotation-web-service-prediction-2:5000;
        }

        # defines a virtual server running on nginx
        # /annotation will be forwarded to the annotation service
        server {
            listen 4000;
            location /api/annotate {
                # will use the upstream "annotation-service" defined above
                proxy_pass http://annotation-service;
            }
            location /api/v1/prediction {
                proxy_pass http://prediction-service;
            }
        }
}